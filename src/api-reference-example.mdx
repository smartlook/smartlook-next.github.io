---
name: API reference EXAMPLE
route: /api-reference-example
---
import { Code, CodeBlock, TextBlock, Alert, Link, MD } from "components";
import { usePlatforms } from 'hooks'

## Custom Events

To track app events programatically, Smartlook provides two groups of methods:

**Custom Events Methods**

<CodeBlock
  snippets={{
    android: {
      java: `
Smartlook.trackCustomEvent(@NonNull String eventName);\n 
Smartlook.trackCustomEvent(@NonNull String eventName, JSONObject eventProperties);
Smartlook.trackCustomEvent(@NonNull String eventName, Bundle eventProperties);
Smartlook.trackCustomEvent(@NonNull String eventName, String validJsonString);
Smartlook.trackCustomEvent(@NonNull String eventName, @NotNull String key, String value);
      `,
      kotlin: `
Smartlook.trackCustomEvent(@NonNull eventName: String)\n
Smartlook.trackCustomEvent(@NonNull eventName: String, eventProperties: JSONObject);
Smartlook.trackCustomEvent(@NonNull eventName: String, eventProperties: Bundle);
Smartlook.trackCustomEvent(@NonNull eventName: String, validJsonString: String);
Smartlook.trackCustomEvent(@NonNull eventName: String, @NotNull key: String, value: String);
      `,
    },
    cordova: {
      javascript: `
Smartlook.trackCustomEvent({name: "sample_event"})
Smartlook.trackCustomEvent( {name: "sample_event", eventProperties: {id: "sample_id", text: "sample text"}})
      `,
    },
    ios: {
      swift: `
Smartlook.trackCustomEvent(name eventName: String)
Smartlook.trackCustomEvent(name: String, props: [String : String]?)
`,
      'objective-c': `
+ (void)trackCustomEventWithName:(nonnull NSString*)eventName;
+ (void)trackCustomEventWithName:(nonnull NSString*)eventName props:(nullable NSDictionary<NSString*, NSString*>*)props;
      `,
    },
    flutter: {
    dart: `
Smartlook.trackCustomEvent(String eventName);
Smartlook.trackCustomEvent(String eventName, [Object map = null]);
`,
  },
  unity: {
    csharp: `
SmartlookUnity.Smartlook.TrackCustomEvent(string eventName);\n
//json string, obtained for example with JsonUtility.ToJson(param)
SmartlookUnity.TrackCustomEvent(string eventName, string properties);
`,
  },
  react: {
    javascript: `
Smartlook.trackCustomEvent(key);
Smartlook.trackCustomEvent(key, map);
`,
  }
  }}
/>

**Timed Custom Events Methods**

<CodeBlock
  snippets={{
    android: {
      java: `
Smartlook.startTimedCustomEvent(@NotNull String eventName);
Smartlook.startTimedCustomEvent(@NotNull String eventName, JSONObject eventProperties);
Smartlook.startTimedCustomEvent(@NotNull String eventName, Bundle eventProperties);
Smartlook.startTimedCustomEvent(@NotNull String eventName, String eventPropertiesJson);\n
Smartlook.stopTimedCustomEvent(@NotNull String eventId);
Smartlook.stopTimedCustomEvent(@NotNull String eventId, JSONObject eventProperties);
Smartlook.stopTimedCustomEvent(@NotNull String eventId, Bundle eventProperties);
Smartlook.stopTimedCustomEvent(@NotNull String eventId, String eventPropertiesJson);\n
Smartlook.cancelTimedCustomEvent(@NotNull String eventId, String reason);
Smartlook.cancelTimedCustomEvent(@NotNull String eventId, String reason, JSONObject eventProperties);
Smartlook.cancelTimedCustomEvent(@NotNull String eventId, String reason, Bundle eventProperties);
Smartlook.cancelTimedCustomEvent(@NotNull String eventId, String reason, String eventPropertiesJson);
      `,
      kotlin: `
Smartlook.startTimedCustomEvent(@NotNull eventName: String)
Smartlook.startTimedCustomEvent(@NotNull eventName: String, eventProperties: JSONObject)
Smartlook.startTimedCustomEvent(@NotNull eventName: String, eventProperties: Bundle)
Smartlook.startTimedCustomEvent(@NotNull eventName: String, eventPropertiesJson: String)\n
Smartlook.stopTimedCustomEvent(@NotNull eventId: String)
Smartlook.stopTimedCustomEvent(@NotNull eventId: String, eventProperties: JSONObject)
Smartlook.stopTimedCustomEvent(@NotNull eventId: String, eventProperties: Bundle)
Smartlook.stopTimedCustomEvent(@NotNull eventId: String, eventPropertiesJson: String)\n
Smartlook.cancelTimedCustomEvent(@NotNull eventId: String, reason: String)
Smartlook.cancelTimedCustomEvent(@NotNull eventId: String, reason: String, eventProperties: JSONObject)
Smartlook.cancelTimedCustomEvent(@NotNull eventId: String, reason: String, eventProperties: Bundle)
Smartlook.cancelTimedCustomEvent(@NotNull eventId: String, reason: String, eventPropertiesJson: String)
      `,
    },
    cordova: {
      javascript: `
Smartlook.startTimedCustomEvent({name: "sample_timed_event", eventProperties: {sample: "object"}});
Smartlook.stopTimedCustomEvent({eventId: "event_id", eventProperties: {sample: "object"}});
Smartlook.cancelTimedCustomEvent({eventId: "event_id", reason: "cancel reason" eventProperties: {sample: "object"}});
      `,
    },
    ios: {
      swift: `
Smartlook.startTimedCustomEvent(name: String, props: [String : String]?) -> Any
Smartlook.trackTimedCustomEvent(eventId: Any, props: [String : String]?)
Smartlook.trackTimedCustomEventCancel(eventId: Any, reason: String?, props: [String : String]?)
`,
      'objective-c': `
 + (id _Nonnull)startTimedCustomEventWithName:(nonnull NSString*)eventName props:(nullable NSDictionary<NSString*, NSString*>*)props;
 // to track successfull events
+ (void)trackTimedCustomEventWithEventId:(id _Nonnull)eventId props:(nullable NSDictionary<NSString*, NSString*>*)props;
// to track event cancellation
+ (void)trackTimedCustomEventCancelWithEventId:(id _Nonnull)eventId reason:(NSString *_Nullable)reason props:(nullable NSDictionary<NSString*, NSString*>*)props;
      `,
    },
    flutter: {
    dart: `
Smartlook.startTimedCustomEvent(String eventName, [Object map = null]);
Smartlook.stopTimedCustomEvent(String key, [Object map = null]);
Smartlook.cancelTimedCustomEvent(String key, String reason, [Object map = null]);
`,
  },
  unity: {
    csharp: `
SmartlookUnity.Smartlook.StartTimedCustomEvent(string eventName);
SmartlookUnity.Smartlook.StartTimedCustomEvent(string eventName, string properties)
SmartlookUnity.Smartlook.StopTimedCustomEvent(string eventId);
SmartlookUnity.Smartlook.StopTimedCustomEvent(string eventId, string properties);
SmartlookUnity.Smartlook.CancelTimedCustomEvent(string eventId, string reason);
SmartlookUnity.Smartlook.CancelTimedCustomEvent(string eventId, string reason, string properties);
`,
  },
  react: {
    javascript: `
Smartlook.startTimedCustomEvent("sample_timed_event", {prop: "propValue"});
Smartlook.stopTimedCustomEvent("event_id", {prop: "propValue"});
Smartlook.stopTimedCustomEvent("event_id", "reason", {prop: "propValue"});
`,
  }
  }}
/>

<Alert kind="important" visibleOn="cordova,react,flutter">
Event properties will effectively use only flat object. 
This means that if you pass json object that includes objects or arrays as a child elements these elements are goint to be ignored.
</Alert>

## Dicussion

There are several use-cases when automated event capturing by Smartlook may not be suficcient for detailed analytics: 

* On some platforms, automated events capturing is technically not possible
* Some parameters that make the event important for analytics can only be provided programatically by the app author
* Some events are not directly caused by user interaction with UI (i.e., detectable automatically as user _clicks_)
* Some events are result of a lenghty, oft assynchronous operation which duration is also important.

For these use-cases, tracking events programatically could be handy.

In the common case, when the event has no duration, the method call is straigthforward:

<Alert kind="example"> 
<CodeBlock
  snippets={{
    android: {
      java: `
Smartlook.trackCustomEvent("CUSTOM_EVENT", eventProperties);
      `,
      kotlin: `
Smartlook.trackCustomEvent("CUSTOM_EVENT", eventProperties:);
      `,
    },
    cordova: {
      javascript: `
Smartlook.trackCustomEvent( {name: "sample_event", eventProperties: {id: "sample_id", text: "sample text"}})
      `,
    },
    ios: {
      swift: `
Smartlook.trackCustomEvent("custom_event", props: [ "some_property" : somePropertyValue ]);\n
`,
      'objective-c': `
[Smartlook trackCustomEventWithName:@"duration_event" props:@{ @"some_property" : somePropertyValue }];
      `,
    },
    flutter: {
    dart: `
an example here
`,
  },
  unity: {
    csharp: `
an example here
`,
  },
  react: {
    javascript: `
an example here
`,
  }
  }}
/>
</Alert>

<Alert kind="note" visibleOn="android">
If you struggle with serialization of your data take a look here.
</Alert>

When, however, the app want to track result of some leghty process, e.g., a result and a duration of a network call, then:

* **Start timed event**: set its name and optional start properties, store the event reference returned by Smartlook. Nothing is tracked at this moment.

* When event ends, **track the event**. Identify the event with the stored event reference. You can also provide additional properties to it. 

* Or, when you want to cancel the event, **track the event canceling**. Identify the event with the stored event reference. You can also provide optional **reason** for the canceling and other additional properties to it. 

By tracking or canceling the event its duration is recorded automatically.

<Alert kind="example"> 
<CodeBlock
  snippets={{
    android: {
      java: `
String eventID = Smartlook.startTimedCustomEvent("duration_event");
Thread.sleep(1000); //long running operation
Smartlook.stopTimedCustomEvent(eventId);
      `,
      kotlin: `
val eventID = Smartlook.startTimedCustomEvent("duration_event")
Thread.sleep(1000) //long running operation
Smartlook.stopTimedCustomEvent(eventId)
      `,
    },
    cordova: {
      javascript: `
var eventID = Smartlook.startTimedCustomEvent({name: "duration_event"});
setTimeout(function() {
Smartlook.stopTimedCustomEvent({eventId: eventId})
}, 1000);
      `,
    },
    ios: {
      swift: `
// start event, and store its reference
let eventRef = Smartlook.startTimedCustomEvent("duration_event", props: [ "some_property" : somePropertyValue ]);\n
// some lenghty operation...\n
// event ends as expected
Smartlook.trackTimedCustomEvent(eventRef, [ "result" : success ? "success" : "failure", "some_result_property" : someResultValue ]);\n
// opetation is cancelled, e.g. by user
Smartlook.trackTimedCustomEventCancel(eventId: eventRef, reason: "cancelled by user")
`,
      'objective-c': `
// start event, and store its reference
id eventRef = [Smartlook startTimedCustomEventWithName:@"duration_event" props:@{ @"some_property" : somePropertyValue }];
// some lenghty operation...\n
// event ends as expected
[Smartlook trackTimedCustomEventWithEventId:eventRef props:@{ @"result" : success ? @"success" : @"failure", @"some_result_property" : someResultValue } ];\n
// opetation is cancelled, e.g. by user
[Smartlook trackTimedCustomEventCancelWithEventId:eventRef reason:@"cancelled by user" props:nil];
      `,
    },
    flutter: {
    dart: `
an example here
`,
  },
  unity: {
    csharp: `
an example here
`,
  },
  react: {
    javascript: `
an example here
`,
  }
  }}
/>
</Alert>

<Alert kind="important">
Properties set in start will be **merged** with properties set while tracking the event. Properties provided with the tracking method have higher priority and will rewrite conflicting strat event properties.
</Alert>

